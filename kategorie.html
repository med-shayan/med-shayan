<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Kategorie â€“ Medizinisches Lexikon</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- HEADER -->
<div id="header"></div>

<!-- CONTENT -->
<div class="container">

  <!-- TITEL -->
  <h1 id="category-title-de" class="lang de"></h1>
  <h1 id="category-title-fa" class="lang fa" dir="rtl"></h1>

  <!-- BESCHREIBUNG -->
  <p class="lang de">Medizinische Fachbegriffe dieser Kategorie:</p>
  <p class="lang fa" dir="rtl">Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ù¾Ø²Ø´Ú©ÛŒ Ø§ÛŒÙ† Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ:</p>

  <!-- LISTE -->
  <div id="kategorie-liste"></div>

  <!-- ZURÃœCK -->
  <p class="lang de">
    <a href="index.html">â† ZurÃ¼ck zur Startseite</a>
  </p>

  <p class="lang fa" dir="rtl">
    <a href="index.html">â† Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
  </p>

</div>

<!-- FOOTER -->
<div id="footer"></div>

<!-- DATEN -->
<script src="begriffe.js"></script>

<!-- ğŸ”’ ZENTRALE LOGIK -->
<script>
let headerLoaded = false;
let footerLoaded = false;

function getCategoryFromURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get("cat");
}

function renderKategorie(lang) {
  const catKey = getCategoryFromURL();
  if (!catKey || !kategorien[catKey]) return;

  // Titel
  document.getElementById("category-title-de").textContent =
    kategorien[catKey].de;
  document.getElementById("category-title-fa").textContent =
    kategorien[catKey].fa;

  const container = document.getElementById("kategorie-liste");
  container.innerHTML = "";

  const gefiltert = begriffe
    .filter(b => b.category === catKey)
    .sort((a, b) => {
      const aName = lang === "fa" ? a.name_fa : a.name_de;
      const bName = lang === "fa" ? b.name_fa : b.name_de;
      return aName.localeCompare(bName, lang === "fa" ? "fa" : "de");
    });

  gefiltert.forEach(b => {
    const p = document.createElement("p");
    const name = lang === "fa" ? b.name_fa : b.name_de;
    p.innerHTML = `<a href="${b.file}">${name}</a>`;
    container.appendChild(p);
  });
}

function setLang(lang) {
  localStorage.setItem("lang", lang);
  document.querySelectorAll(".lang").forEach(el => el.style.display = "none");
  document.querySelectorAll("." + lang).forEach(el => el.style.display = "block");
  renderKategorie(lang);
}

function initIfReady() {
  if (headerLoaded && footerLoaded) {
    const lang = localStorage.getItem("lang") || "de";
    setLang(lang);
  }
}

fetch("header.html")
  .then(r => r.text())
  .then(h => {
    document.getElementById("header").innerHTML = h;
    headerLoaded = true;
    initIfReady();
  });

fetch("footer.html")
  .then(r => r.text())
  .then(f => {
    document.getElementById("footer").innerHTML = f;
    footerLoaded = true;
    initIfReady();
  });
</script>

</body>
</html>
