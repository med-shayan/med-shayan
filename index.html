<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Medizinisches Lexikon</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- HEADER -->
<div id="header"></div>

<!-- CONTENT -->
<div class="container">

  <!-- TITEL -->
  <h1 class="lang de">Medizinisches Lexikon</h1>
  <h1 class="lang fa" dir="rtl">ÙˆØ§Ú˜Ù‡â€ŒÙ†Ø§Ù…Ù‡ Ù¾Ø²Ø´Ú©ÛŒ</h1>

  <!-- BESCHREIBUNG -->
  <p class="lang de">
    Kurze und verstÃ¤ndliche ErklÃ¤rungen medizinischer Fachbegriffe
    fÃ¼r medizinisch Interessierte, SchÃ¼ler und Auszubildende.
  </p>

  <p class="lang fa" dir="rtl">
    ØªÙˆØ¶ÛŒØ­Ø§Øª Ø³Ø§Ø¯Ù‡ Ùˆ Ù‚Ø§Ø¨Ù„ ÙÙ‡Ù… Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ù¾Ø²Ø´Ú©ÛŒ
    Ø¨Ø±Ø§ÛŒ Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯Ø§Ù†ØŒ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ùˆ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù† Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø²Ø´Ú©ÛŒ.
  </p>

  <!-- SEARCH -->
  <div class="section">
    <h3 class="lang de">Suche</h3>
    <h3 class="lang fa" dir="rtl">Ø¬Ø³ØªØ¬Ùˆ</h3>

    <input
      type="text"
      id="search"
      class="search-input"
      placeholder=""
    >

    <div id="search-results"></div>
  </div>

  <!-- KATEGORIEN -->
  <div class="section">
    <h3 class="lang de">Kategorien</h3>
    <h3 class="lang fa" dir="rtl">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</h3>

    <div id="kategorien-liste"></div>
  </div>

  <!-- AUTOR -->
  <p class="lang de"><strong>von Shayan Daneshkhah</strong></p>
  <p class="lang fa" dir="rtl"><strong>ØªÙ‡ÛŒÙ‡â€ŒØ´Ø¯Ù‡ ØªÙˆØ³Ø· Ø´Ø§ÛŒØ§Ù† Ø¯Ø§Ù†Ø´â€Œ Ø®ÙˆØ§Ù‡</strong></p>

</div>

<!-- FOOTER -->
<div id="footer"></div>

<!-- DATEN -->
<script src="begriffe.js"></script>
<script src="search.js"></script>

<!-- LOGIK -->
<script>
/* =========================
   KATEGORIEN
========================= */
function renderKategorien(lang) {
  const container = document.getElementById("kategorien-liste");
  if (!container || typeof kategorien === "undefined") return;

  container.innerHTML = "";

  Object.keys(kategorien).forEach(key => {
    const name = kategorien[key][lang];
    const p = document.createElement("p");
    p.innerHTML = `<a href="kategorie.html?cat=${key}">${name}</a>`;
    container.appendChild(p);
  });
}

/* =========================
   SPRACHE SETZEN
========================= */
function setLang(lang) {
  localStorage.setItem("lang", lang);

  document.querySelectorAll(".lang").forEach(el => {
    el.style.display = "none";
  });

  document.querySelectorAll(".lang." + lang).forEach(el => {
    el.style.display = "block";
  });

  if (typeof setSearchLang === "function") {
    setSearchLang(lang);
  }

  const searchInput = document.getElementById("search");
  if (searchInput) {
    searchInput.placeholder =
      lang === "fa"
        ? "Ø§ØµØ·Ù„Ø§Ø­ Ù¾Ø²Ø´Ú©ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"
        : "Medizinischen Begriff eingeben";
  }

  renderKategorien(lang);
}

/* =========================
   HEADER-BUTTONS AKTIVIEREN
========================= */
function initLangButtons() {
  const buttons = document.querySelectorAll(".lang-switch button");

  buttons.forEach(btn => {
    btn.addEventListener("click", () => {
      const lang = btn.getAttribute("data-lang");
      setLang(lang);
    });
  });
}

/* =========================
   HEADER & FOOTER LADEN
========================= */
let headerLoaded = false;
let footerLoaded = false;

function initLangIfReady() {
  if (headerLoaded && footerLoaded) {
    const savedLang = localStorage.getItem("lang") || "de";
    setLang(savedLang);
  }
}

fetch("header.html")
  .then(r => r.text())
  .then(h => {
    document.getElementById("header").innerHTML = h;
    initLangButtons(); // ğŸ”‘ DAS FEHLTE
    headerLoaded = true;
    initLangIfReady();
  });

fetch("footer.html")
  .then(r => r.text())
  .then(f => {
    document.getElementById("footer").innerHTML = f;
    footerLoaded = true;
    initLangIfReady();
  });
</script>

</body>
</html>
